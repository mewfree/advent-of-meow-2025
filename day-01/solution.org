#+title: Advent of Code 2025 Day 1
#+property: header-args :tangle solution.ml

#+begin_src ocaml :exports both
let parse str =
  Scanf.sscanf str "%c%d" (fun dir num ->
    match dir with
    | 'L' -> -num
    | 'R' -> num
    | _ -> failwith "Invalid direction"
  )

let input =
  In_channel.with_open_text "example.txt" In_channel.input_all
  |> String.split_on_char '\n'
  |> List.filter (fun s -> s <> "")
  |> List.map parse
#+end_src

#+RESULTS:
| -68 | -30 | 48 | -5 | 60 | -55 | -1 | -99 | 14 | -82 |

#+begin_src ocaml :exports both
let scan_mod start values =
  let positive_mod n = let r = n mod 100 in if r < 0 then r + 100 else r in
  List.to_seq values
  |> Seq.scan (fun pos delta -> positive_mod (pos + delta)) start
  |> Seq.drop 1
  |> List.of_seq

let result = scan_mod 50 input
#+end_src

#+RESULTS:
| 82 | 52 | 0 | 95 | 55 | 0 | 99 | 0 | 14 | 32 |

#+begin_src ocaml :exports both
let zero_count =
  result
  |> List.filter (fun x -> x = 0)
  |> List.length
#+end_src

#+RESULTS:
: 3

#+begin_src ocaml :results none :exports none
let () = print_endline ("Result: " ^ string_of_int zero_count)
#+end_src
